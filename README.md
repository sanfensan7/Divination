# 智能算命 Divination

一款集成中国传统与西方占卜术于一体的综合性算命应用，支持多种命理分析方法，提供专业、客观且全面的命运解读。

## 功能特点

- **多元化的算命方法**：包含八字、紫微斗数、周易卦象、塔罗牌、占星术和数字命理学等中西方传统算命方式
- **精准的命理分析**：结合传统理论与现代心理学，提供既传统又实用的解读
- **平衡的分析视角**：不仅展示命运优势，也客观指出潜在风险与挑战
- **老黄历功能**：查看每日宜忌、吉凶方位和传统节气信息
- **个性化分析**：根据用户提供的生日、时间等信息生成专属命理报告
- **深度AI整合**：支持接入DeepSeek API，提供更深入、专业的算命结果
- **本地模拟模式**：无需网络连接，也可使用内置模拟引擎生成结果
- **周公解梦功能**：提供专业的梦境解析，融合传统文化和现代心理学

## 支持的算命方法

### 中国传统算命

- **八字命理**：基于生辰八字的命运分析，解读五行属性与大运流年
- **紫微斗数**：通过星宿排盘解析人生各方面运势
- **周易卦象**：易经六十四卦预测
- **老黄历**：查询每日宜忌、吉凶方位和时辰信息
- **周公解梦**：分析梦境蕴含的预示与寓意，提供传统解读与现代解析

### 西方传统占卜

- **占星术**：通过星盘解读性格与命运
- **塔罗牌**：利用塔罗牌阵进行命运预测
- **数字命理学**：分析生日数字的能量与意义

## 主要功能模块

1. **首页**：展示老黄历信息与算命方法推荐
2. **算命方法**：提供各种算命方式的选择，分为中国传统和西方传统两大类
3. **个人中心**：保存历史算命结果，方便回顾与比较
4. **设置**：配置DeepSeek API密钥、偏好设置等
5. **解梦专区**：输入梦境内容，获取专业解梦分析

## 技术实现

- **开发语言**：Kotlin
- **UI框架**：Android原生视图系统
- **图形绘制**：自定义视图实现塔罗牌动画等专业图形
- **AI集成**：DeepSeek API提供深度分析
- **本地存储**：保存用户历史记录与偏好设置

## 使用说明

1. **基本使用**：
   - 在首页查看今日老黄历信息
   - 通过底部导航进入算命页面选择喜欢的算命方式
   - 输入必要的个人信息（如出生日期、时间等）
   - 获取详细的命理分析结果

2. **高级功能**：
   - 在设置中配置DeepSeek API密钥，获取更高质量的AI分析
   - 保存感兴趣的结果，建立个人命理档案
   - 使用解梦功能分析梦境的深层含义

## 安装要求

- Android 8.0 (API 26)及以上系统
- 建议屏幕分辨率1080x1920或更高
- 至少100MB可用存储空间

## 开发环境

- Android Studio Arctic Fox或更高版本
- Kotlin 1.5+
- Gradle 7.0+
- JDK 11

## 项目结构

```
app/
├── src/main/
│   ├── java/com/example/divination/
│   │   ├── model/          # 数据模型类
│   │   ├── utils/          # 工具类与服务
│   │   ├── view/           # 自定义视图
│   │   ├── ui/             # UI组件与Fragment
│   │   └── MainActivity.kt # 主活动
│   ├── res/                # 资源文件
│   └── AndroidManifest.xml # 应用清单
└── build.gradle.kts        # 构建配置
```

## 开源许可

本项目采用MIT许可证。详情请参阅LICENSE文件。

## 特别说明

本应用提供的命理分析仅供娱乐参考，不应作为重大决策的依据。我们鼓励用户理性看待命理解读，将其作为生活的参考而非绝对准则。

## 最近更新 - 2024-06-22

### 修复的问题

1. **删除结果末尾的字数统计文本**
   - 增强了`parseResponseToSections`方法中处理字数统计文本的正则表达式
   - 添加了多种可能的格式变体，如"（全文共计***字"、"(共计***字"等
   - 确保所有可能的字数统计文本都能被正确删除

2. **优化塔罗牌内容分段功能**
   - 改进了`splitTarotContent`方法的分段能力：
     - 能够识别并使用内容中已有的标题格式（如【】、[]、()等）
     - 增加了更多关键词来识别不同类型的段落（如概览、牌面解读、分析、建议等）
     - 添加了智能分段功能，在无法识别明确段落标识时，根据内容长度比例自动分段
   - 确保塔罗牌解析结果始终呈现清晰的分段结构

### 新增功能

3. **周公解梦功能完善**
   - 添加了专门的`simulateDreamResponse`模拟响应方法，支持解梦分析
   - 实现了智能梦境内容识别，能够从用户输入中提取关键梦境元素
   - 包含29种常见梦境类型的专业解析（如飞行、坠落、考试、亲人等）
   - 提供分层结构化的解梦结果：
     - 梦境概述：梦境类型和形成原因分析
     - 传统解读：基于《周公解梦》的传统文化解析
     - 现代解析：融合现代心理学和神经科学的解释
     - 启示与建议：基于梦境内容的个性化指导
   - 智能判断梦境吉凶，不同梦境类型有不同的权重分配
   - 引用经典解梦理论，增强解析的文化深度

4. **UI界面优化**
   - 重新设计了主页面布局，提升用户体验
   - 优化了算命结果展示页面，增加动画效果
   - 新增黑暗模式支持，保护夜间使用时的视力
   - 改进了卡片视图设计，使界面更加现代化

5. **系统性能提升**
   - 优化了AI请求处理流程，减少等待时间
   - 引入缓存机制，提高频繁访问内容的加载速度
   - 减少内存占用，提升应用运行稳定性

这些改进确保了应用能够更好地处理各种格式的AI响应，提供更清晰、结构化的占卜结果展示，同时大幅提升了用户体验。 